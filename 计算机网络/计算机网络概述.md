
以下内容主要学下于[CS-Notes](https://github.com/CyC2018/CS-Notes)

## 网络的网络

网络把主机连接起来，而互联网是把多种不同的网络连接起来，因此互联网是网络的网络。

<div align="center">

![title](https://raw.githubusercontent.com/XQLong/Logging/master/img/2019/07/29/1564382407345-1564382407546.png)

</div>

## 互联网服务提供商（ISP）

互联网服务提供商（Internet Service Provider）可以从互联网管理机构获得许多IP地址，同时拥有通信线路及路由器等联网设备，个人或机构向ISP缴纳一定的费用就可以接入互联网。

<div align="center">

![title](https://raw.githubusercontent.com/XQLong/Logging/master/img/2019/07/29/1564383097823-1564383097828.png)

</div>

目前互联网是一种多层次ISP结构，ISP根据覆盖面积的大小分为第一层ISP、区域ISP和接入ISP。互联网交换点IXP(Internet eXchange Point)允许两个ISP直接相连而不用经过第三个ISP。如下图所示:

<div align="center">

![title](https://raw.githubusercontent.com/XQLong/Logging/master/img/2019/07/29/1564383406217-1564383406221.png)

</div>

## 主机之间的通信方式

- C/S（客户/服务器）：客户是服务的请求方，服务器是服务的提供方。
- P2P(对等)：不区分客户和服务器。

## 数据交换

如何实现数据通过网络核心从源主机到达目的主机？就要经过网络核心进行数据交换，数据不断从一个网络交换到另一个网络，直到达到目的主机。所以网络核心解决的基本问题就是数据交换。数据交换一般包括电路交换、报文交换和分组交换三种。

- 电路交换：

最典型的电路交换网络如电话网络，交换的过程包括建立连接、通信、释放连接三个过程。电路交换是独占资源的，建立连接之后，就会独占这条链路进行数据交换，但不是物理链路上只有这一条连接，因为电路交换会进行多路复用。

<div align="center">

![title](https://raw.githubusercontent.com/XQLong/Logging/master/img/2019/07/29/1564385380782-1564385380786.png)

</div>

优点：

1. 由于通信线路为通信双方用户专用，数据直达，所以传输数据的时延非常小；
2. 通信双方的物理链路一旦建立，双方可以随时通信，实时性强；
3. 双方通信时按发送顺序传送数据，不存在失序问题；
4. 电路交换既适用于传输模拟信号，也适用于传输数字信号；
5. 电路交换的交换设备及控制均较简单，

缺点：
1. 电路交换的平均连接建立时间对计算机通信来说嫌长；
2. 电路交换连接建立以后，物理通路被通信双方独占，即使通信线路空闲，也不能供其它用户使用，因而信道利用率低；
3. 电路交换时，数据直达，不同类型、不同规格、不同速率的终端很难相互进行通信，也难以在通信过程中进行差错控制。


- 报文交换

报文交换是以报文为数据交换的单位，报文携带有目标地址、源地址等信息在交换节点采用存储转发的传输方式。

其中报文是源（应用）发送信息的整体。是网络中交换与传输的数据单元，即站点一次性要发送的数据块。报文包含了将要发送的完整数据信息，其长短很不一致，长度不限且可变。比如要发送一个文件，那么这个文件的信息就是要发送的报文。

存储转发：是计算机网络领域使用的最为广泛的技术之一，以太网交换机的控制器先将输入端口到来的数据包缓存起来，先检查数据包是否正确，并过滤冲突包错误。确定包正确后，取出目的地址，通过查找表找到想要发送的输出端口地址，然后将该包发送出去。

优点：
1. 报文交换不需要为通信双方建立一条专用的通信线路，不存在连接建立时延，用户可以随时发送报文；
2. 由于采用存储转发的方式使其具有以下优点：在报文交换中便于设置代码检验和数据重发设施，加之交换结点还具有路径选择，就可以做到某条传输路径发生故障时，重新选择另一条路径传输数据，提高了传输的可靠性；在存储转发中容易实现代码转换和速率匹配，甚至收发双方可以不同时处于可用状态，这样就便于类型、规格和速度不同的计算机之间进行通信；提供多目标服务，即一个报文可以同时发送到多个目的地址，这在电路交换中是很难实现的；允许建立数据传输的优先级，使优先级高的报文优先转换。
3. 通信双方不是固定占有一条通信线路，而是在不同的时间一段一段地部分占有这条物理通路，因而大大提高了通信线路的利用率。

缺点：
1. 由于数据进入交换节点后要经历存储、转发这一过程，从而引起转发时延（包括接收报文、检验正确性、排队、发送时间等），而且网络的通信量愈大，造成的时延愈大，因此报文交换的实时性差，不适合传送实时或交互式的业务数据。
2. 报文交换只适用于数字信号；
3. 由于报文长度没有限制，而每个中间节点都要完整地接收传来的整个报文，当输出线路不空闲时，还可能要存储几个完整报文等待转发，要求网络中每个结点有较大的缓冲区。为了降低成本，减少结点的缓冲存储器的容量，有时要把等待转发的报文存在磁盘上，进一步增加了传送时延。


- 分组交换

分组交换仍采用存储转发的传输方式，但将一个长报文分割为若干个较短的分组，然后把这些分组（携带源、目标地址和编号信息）逐个地发送出去，因此分组交换除了具有报文交换的优点外相比具有如下的优缺点：

优点：
1. 加速了数据在网络中的传输。因为分组是逐个传输，可以使后一个分组的存储操作与前一个分组的转发操作并行，这种流水线式传输方式减少了报文的传输时间。此外，传输一个分组所需的缓冲区比传输一份报文所需的缓冲区小得多，这样因缓冲区不足而等待发送的机率及等待的时间也必然少得多。
2. 简化了存储管理。因为分组的长度固定，相应的缓冲区的大小也固定，在交换结点中存储器的管理通常被简化为对缓冲区的管理，相对比较容易。
3. 减少了出错机率和重发数据量。因为分组较短，其出错机率必然减少，每次重发的数据量也就大大减少，这样不仅提高了可靠性，也减少了传输时延。
4. 由于分组短小，更适用于采用优先级策略，便于及时传送一些紧急数据，因此对于计算机之间的突发式的数据通信，分组交换显然更为合适些。

缺点：
1. 尽管分组交换比报文交换的传输时延少，但仍存在存储转发时延，而且其结点交换机必须具有更强的处理能力。
2. 分组交换与报文交换一样，每个分组都要加上源、目的地址和分组编号等信息，使传送的信息量大约增大5%～10%，一定程度上降低了通信效率，增加了处理的时间，使控制复杂，时延增加。
3. 当分组交换采用数据报服务时，可能出现失序、丢失或重复分组，分组到达目的结点时，要对分组按编号进行排序等工作，增加了麻烦。若采用虚电路服务，虽无失序问题，但有呼叫建立、数据传输和虚电路释放三个过程。

- 总结

若要传送的数量很大，且其传送时间远远大于呼叫时间，则采用电路交换较为合适；当端到端的通路由很多段的链路组成时，采用分组交换传送数据较为合适。从提高整个网络的信道利用率上看，报文交换和分组交换优于电路交换，其中分组交换比报文交换的延时小，尤其适合于计算机之间的突发式的数据通信。

## 时延

总时延 = 排队时延 + 处理时延 + 传输时延 + 传播时延

<div align="center">

![title](https://raw.githubusercontent.com/XQLong/Logging/master/img/2019/07/29/1564405332127-1564405332136.png)

</div>

- 排队时延：分组在路由器的输入队列和输出队列中排队等待的时间，取决于网络当前的通信量；
- 处理时延：主机或路由器收到分组时进行处理所需要的时间，例如分析首部、从分组中提取数据、进行差错检验或查找适当的路由等；
- 传输时延：主机或路由器传输数据帧所需要的时间；
- 传播时延：电磁波在信道中传播所需要花费的时间，电磁波传播的速度接近光速。

## 计算机网络体系结构

<div align="center">

![title](https://raw.githubusercontent.com/XQLong/Logging/master/img/2019/07/29/1564406192238-1564406192244.png)

</div>

### 1、五层协议

- 应用层：为特定应用程序提供数据传输服务，例如 HTTP、DNS 等协议。数据单位为报文。
- 传输层：为进程提供通用数据传输服务。由于应用层协议很多，定义通用的传输层协议就可以支持不断增多的应用层协议。运输层包括两种协议：传输控制协议 TCP，提供面向连接、可靠的数据传输服务，数据单位为报文段；用户数据报协议 UDP，提供无连接、尽最大努力的数据传输服务，数据单位为用户数据报。TCP 主要提供完整性服务，UDP 主要提供及时性服务。
- 网络层：为主机提供数据传输服务。而传输层协议是为主机中的进程提供数据传输服务。网络层把传输层传递下来的报文段或者用户数据报封装成分组。
- 数据链路层：网络层针对的还是主机之间的数据传输服务，而主机之间可以有很多链路，链路层协议就是为同一链路的主机提供数据传输服务。数据链路层把网络层传下来的分组封装成帧。
- 物理层：考虑的是怎样在传输媒体上传输数据比特流，而不是指具体的传输媒体。物理层的作用是尽可能屏蔽传输媒体和通信手段的差异，使数据链路层感觉不到这些差异。

### 2、OSI（Open System Interconnect）

### 3、TCP/IP

